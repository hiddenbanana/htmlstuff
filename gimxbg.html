<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Glitch Video + Modal (Font Awesome)</title>

  <!-- FONT AWESOME -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body, html { margin:0; padding:0; height:100%; overflow:hidden; font-family: 'Segoe UI', sans-serif; }
    #bg-video {
      position: fixed; top: 50%; left: 50%; min-width: 100%; min-height: 100%;
      width: auto; height: auto; transform: translate(-50%, -50%);
      z-index: -1; object-fit: cover;
    }
    #logo-container {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      z-index: 1; pointer-events: none;
    }
    #logo {
      max-width: 600px; width: 100%; height: auto;
      filter: drop-shadow(0 0 14px rgba(0,0,0,0.8));
    }

    /* Modal */
    #modal {
      position: fixed; top: 20px; left: 20px; z-index: 10;
      background: rgba(0,0,0,0.85); padding: 16px 20px; border-radius: 14px;
      display: flex; gap: 12px; align-items: center; color: white;
      box-shadow: 0 8px 32px rgba(0,0,0,0.6); backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    #modal.hidden { transform: translateY(-120%); opacity: 0; pointer-events: none; }

    #search-input {
      padding: 10px 12px 10px 36px; font-size: 16px; border: 2px solid #fff;
      border-radius: 8px; background: rgba(255,255,255,0.1); color: white;
      width: 220px; position: relative;
    }
    #search-input::placeholder { color: rgba(255,255,255,0.7); }
    #search-input:focus { outline: none; border-color: #00ffcc; }

    /* Icon inside input */
    #search-container { position: relative; display: inline-block; }
    #search-container i {
      position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
      color: #aaa; font-size: 18px; pointer-events: none;
    }

    #search-btn, #next-btn {
      padding: 10px 16px; background: rgba(0,255,255,0.2); color: white;
      border: 2px solid #00ffcc; border-radius: 8px; font-weight: bold;
      cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 6px;
    }
    #search-btn:hover, #next-btn:hover {
      background: #00ffcc; color: #000; transform: translateY(-1px);
    }

    /* Toggle Button */
    #toggle-modal {
      position: fixed; top: 20px; left: 20px; z-index: 11;
      width: 50px; height: 50px; background: rgba(0,255,255,0.2);
      border: 2px solid #00ffcc; border-radius: 50%; color: white;
      font-size: 22px; line-height: 46px; text-align: center;
      cursor: pointer; backdrop-filter: blur(6px);
      transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    #toggle-modal:hover {
      background: #00ffcc; color: #000; transform: scale(1.15) rotate(90deg);
    }
  </style>
</head>
<body>

  <video id="bg-video" autoplay muted playsinline></video>

  <div id="logo-container">
    <img id="logo" src="https://github.com/hiddenbanana/htmlstuff/blob/main/GIMX-LOGO-white.png?raw=true" alt="Logo">
  </div>

  <!-- TOGGLE BUTTON -->
  <div id="toggle-modal" title="Toggle Controls"><i class="fas fa-cog"></i></div>

  <!-- MODAL -->
  <div id="modal" class="hidden">
    <div id="search-container">
      <i class="fas fa-search"></i>
      <input id="search-input" type="text" placeholder="Search videos..." />
    </div>
    <button id="search-btn"><i class="fas fa-search"></i> Search</button>
    <button id="next-btn"><i class="fas fa-step-forward"></i> Next</button>
  </div>

  <script>
    const API_KEY = 'ZF8qy3fNZlH3TCELlBKW9uK3fnFDZsvk6ZozOgXiGvIARDWd6q1EL4ha';
    const VIDEO_ELEMENT = document.getElementById('bg-video');
    const SEARCH_INPUT = document.getElementById('search-input');
    const SEARCH_BTN = document.getElementById('search-btn');
    const NEXT_BTN = document.getElementById('next-btn');
    const MODAL = document.getElementById('modal');
    const TOGGLE = document.getElementById('toggle-modal');

    let videoCache = [];
    let usedVideos = new Set();
    let currentQuery = 'glitch';

    async function fetchVideoBatch() {
      const query = currentQuery.trim() || 'glitch';
      try {
        const resp = await fetch(
          `https://api.pexels.com/videos/search?query=${encodeURIComponent(query)}&per_page=30`,
          { headers: { Authorization: API_KEY } }
        );
        if (!resp.ok) throw new Error(`Pexels error: ${resp.status}`);
        const data = await resp.json();
        return data.videos || [];
      } catch (e) {
        console.error(e);
        return [];
      }
    }

    function getRandomVideo() {
      const available = videoCache.filter(v => !usedVideos.has(v.id));
      if (available.length === 0) {
        usedVideos.clear();
        if (videoCache.length === 0) return null;
      }
      const vid = available.length 
        ? available[Math.floor(Math.random() * available.length)]
        : videoCache[Math.floor(Math.random() * videoCache.length)];
      usedVideos.add(vid.id);
      return vid;
    }

    async function loadNextVideo() {
      if (videoCache.length < 5) {
        const newBatch = await fetchVideoBatch();
        videoCache.push(...newBatch);
      }
      const vid = getRandomVideo();
      if (!vid) return;
      const file = vid.video_files.slice(-1)[0].link;
      VIDEO_ELEMENT.src = file;
      VIDEO_ELEMENT.load();
      VIDEO_ELEMENT.play().catch(() => {});
    }

    function performSearch() {
      const input = SEARCH_INPUT.value.trim();
      currentQuery = input || 'glitch';
      videoCache = [];
      usedVideos.clear();
      loadNextVideo();
    }

    SEARCH_BTN.addEventListener('click', performSearch);
    SEARCH_INPUT.addEventListener('keypress', e => {
      if (e.key === 'Enter') performSearch();
    });

    // Toggle modal with animation
    TOGGLE.addEventListener('click', () => {
      const isHidden = MODAL.classList.toggle('hidden');
      TOGGLE.innerHTML = isHidden ? '<i class="fas fa-cog"></i>' : '<i class="fas fa-times"></i>';
    });

    VIDEO_ELEMENT.addEventListener('ended', loadNextVideo);
    NEXT_BTN.addEventListener('click', loadNextVideo);

    loadNextVideo();
  </script>
</body>
</html>
